<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Hll (grenier.Hll)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">grenier</a> &#x00BB; Hll</nav><header class="odoc-preamble"><h1>Module <code><span>Hll</span></code></h1><p>An implementation of HyperLogLog probabilistic cardinality estimator.</p></header><nav class="odoc-toc"><ul><li><a href="#serialization">Serialization</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>Type of HyperLogLog counters</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make"><a href="#val-make" class="anchor"></a><code><span><span class="keyword">val</span> make : <span><span class="label">error</span>:float <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Create a new counter with <code>error</code> error rate. <code>error</code> should verify <code>0.0 &lt; error &amp;&amp; error &lt; 1.0</code>. <code>0.05</code> is a reasonable default.</p><p>Use <code>estimate_memory</code> to measure memory consumption and runtime of this function.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-add"><a href="#val-add" class="anchor"></a><code><span><span class="keyword">val</span> add : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>int64 <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>add t k</code> counts item <code>k</code> in <code>t</code>.</p><p><code>k</code> should be &quot;random&quot;: it should be the output of some cryptographic hashing algorithm like SHA. It is not treated as an integer. This is key to getting proper results. No patterns should appear in the bits of the different items added.</p><p>Runtime is O(1).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-estimate_memory"><a href="#val-estimate_memory" class="anchor"></a><code><span><span class="keyword">val</span> estimate_memory : <span><span class="label">error</span>:float <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>Estimate the memory consumed in bytes by a counter with the specified error rate.</p><p>This ignores the constant overhead of the OCaml representation, around two words. It is a <code>bytes</code> of <code>estimate_memory ~error + 1</code> length.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-card"><a href="#val-card" class="anchor"></a><code><span><span class="keyword">val</span> card : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> float</span></code></div><div class="spec-doc"><p>Get the cardinality estimation. Defaults to HyperLogLog++.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-card_hll"><a href="#val-card_hll" class="anchor"></a><code><span><span class="keyword">val</span> card_hll : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> float</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-card_hllpp"><a href="#val-card_hllpp" class="anchor"></a><code><span><span class="keyword">val</span> card_hllpp : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> float</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-copy"><a href="#val-copy" class="anchor"></a><code><span><span class="keyword">val</span> copy : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Get a copy of a counter.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-merge"><a href="#val-merge" class="anchor"></a><code><span><span class="keyword">val</span> merge : <span><span class="label">into</span>:<a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>merge ~into:t0 t'</code> has the same effect as adding all items added to <code>t'</code> to <code>t0</code>.</p><p><code>t0</code> and <code>t'</code> must have been constructed with the same error rate!</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-clear"><a href="#val-clear" class="anchor"></a><code><span><span class="keyword">val</span> clear : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Reset counter to 0.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-hash_int64"><a href="#val-hash_int64" class="anchor"></a><code><span><span class="keyword">val</span> hash_int64 : <span>int64 <span class="arrow">&#45;&gt;</span></span> int64</span></code></div><div class="spec-doc"><p>The following algorithm provide a reasonable hashing function for integers, if you want to feed the HLL with &quot;normal&quot; integers.</p></div></div><h1 id="serialization"><a href="#serialization" class="anchor"></a>Serialization</h1><div class="odoc-spec"><div class="spec value anchored" id="val-to_string"><a href="#val-to_string" class="anchor"></a><code><span><span class="keyword">val</span> to_string : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Returns a string with the current state stored.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-of_string"><a href="#val-of_string" class="anchor"></a><code><span><span class="keyword">val</span> of_string : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Restore a HLL saved with <code>to_string</code>.</p><p><code>of_string (to_string t)</code> is functionnally equivalent to <code>copy t</code>, except a bit more expensive.</p><p>It can raise <code>Invalid_argument</code> if the string provided was not saved by <code>to_string</code>.</p></div></div></div></body></html>
